#!/bin/sh
. "$(dirname "$0")/_/husky.sh"

export LC_ALL=en_US.UTF-8
export LANG=pt_BR.UTF-8
RED=$(tput setaf 1)
GREEN=$(tput setaf 2)
RESET=$(tput sgr0)

echo "ğŸš€ Preparing to commit changes..."
echo "----------------------------------"

echo "ğŸ¨ Checking C# file formatting with CSharpier..."
if dotnet csharpier . --check; then
    echo "âœ… All files are properly formatted."
else
    echo "âŒ Some files need formatting. Formatting now..."
    dotnet csharpier .
    echo "âœ… Files formatted successfully. Adding to commit..."
fi

echo "ğŸ› ï¸ Running format check on staged files..."
dotnet husky run --name dotnet-format-csharpier || {
    echo "âŒ Format checks failed. Please fix the issues and try again."
    exit 1
}

echo "----------------------------------"
echo "âœ… Pre-commit checks completed successfully."

let e = null;
async function s(t) {
  try {
    e = new WebTorrent(), t.textContent = "Ready to play";
  } catch (r) {
    throw r;
  }
}
async function h(t, r, d) {
  try {
    const n = document.querySelector(r);
    if (!n) throw new Error("Container not found");
    n.innerHTML = `
            <video controls playsinline 
                style="width:100%;height:100%;object-fit:contain;background:#000;">
            </video>
        `;
    const i = n.querySelector("video");
    e.add(d, (c) => {
      const a = c.files.find(
        (o) => o.name.endsWith(".mp4") || o.name.endsWith(".mkv") || o.name.endsWith(".webm")
      );
      if (!a) throw new Error("No video file found");
      a.getBlobURL((o, l) => {
        if (o) throw o;
        i && (i.src = l, i.play().catch(console.error));
      }), c.on("download", () => {
        t.textContent = `Loading: ${(c.progress * 100).toFixed(1)}%`;
      });
    });
  } catch (n) {
    throw n;
  }
}
async function w() {
  e && (e.destroy(), e = new WebTorrent());
}
export {
  s as initTorrentPlayer,
  h as startDownload,
  w as stopDownload
};
